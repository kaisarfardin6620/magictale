Watching for file changes with StatReloader
Watching for file changes with StatReloader
message='Request to Stripe api' method=post url=https://api.stripe.com/v1/customers
api_version=2025-07-30.basil message='Post details' post_data=email=kaisarfardin128%40gmail.com
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "POST /v1/customers HTTP/1.1" 200 637
message='Stripe API response' path=https://api.stripe.com/v1/customers response_code=200
body='{\n  "id": "cus_StGLAD8xMjEliF",\n  "object": "customer",\n  "address": null,\n  "balance": 0,\n  "created": 1755526451,\n  "currency": null,\n  "default_source": null,\n  "delinquent": false,\n  "description": null,\n  "discount": null,\n  "email": "kaisarfardin128@gmail.com",\n  "invoice_prefix": "R25XXUMC",\n  "invoice_settings": {\n    "custom_fields": null,\n    "default_payment_method": null,\n    "footer": null,\n    "rendering_options": null\n  },\n  "livemode": false,\n  "metadata": {},\n  "name": null,\n  "next_invoice_sequence": 1,\n  "phone": null,\n  "preferred_locales": [],\n  "shipping": null,\n  "tax_exempt": "none",\n  "test_clock": null\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_d4ubLgijkDR5yg message='Dashboard link for request'
message='Request to Stripe api' method=post url=https://api.stripe.com/v1/checkout/sessions
api_version=2025-07-30.basil message='Post details' post_data=payment_method_types[0]=card&customer=cus_StGLAD8xMjEliF&line_items[0][price]=price_1RwsTM090fCkwKBzzGwDxzmH&line_items[0][quantity]=1&mode=subscription&subscription_data[trial_period_days]=14&success_url=http%3A%2F%2Flocalhost%3A3000%2Fsuccess%3Fsession_id%3D%7BCHECKOUT_SESSION_ID%7D&cancel_url=http%3A%2F%2Flocalhost%3A3000%2Fcancel
https://api.stripe.com:443 "POST /v1/checkout/sessions HTTP/1.1" 200 2719
message='Stripe API response' path=https://api.stripe.com/v1/checkout/sessions response_code=200
body='{\n  "id": "cs_test_a1O1u7QGnd7d2ZzaRYYaUqMO4TCzD2DHD0BtuHOSPDlOs1GA4CvnJNfmhG",\n  "object": "checkout.session",\n  "adaptive_pricing": {\n    "enabled": false\n  },\n  "after_expiration": null,\n  "allow_promotion_codes": null,\n  "amount_subtotal": 0,\n  "amount_total": 0,\n  "automatic_tax": {\n    "enabled": false,\n    "liability": null,\n    "provider": null,\n    "status": null\n  },\n  "billing_address_collection": null,\n  "cancel_url": "http://localhost:3000/cancel",\n  "client_reference_id": null,\n  "client_secret": null,\n  "collected_information": {\n    "shipping_details": null\n  },\n  "consent": null,\n  "consent_collection": null,\n  "created": 1755526451,\n  "currency": "usd",\n  "currency_conversion": null,\n  "custom_fields": [],\n  "custom_text": {\n    "after_submit": null,\n    "shipping_address": null,\n    "submit": null,\n    "terms_of_service_acceptance": null\n  },\n  "customer": "cus_StGLAD8xMjEliF",\n  "customer_creation": null,\n  "customer_details": {\n    "address": null,\n    "email": "kaisarfardin128@gmail.com",\n    "name": null,\n    "phone": null,\n    "tax_exempt": "none",\n    "tax_ids": null\n  },\n  "customer_email": null,\n  "discounts": [],\n  "expires_at": 1755612851,\n  "invoice": null,\n  "invoice_creation": null,\n  "livemode": false,\n  "locale": null,\n  "metadata": {},\n  "mode": "subscription",\n  "origin_context": null,\n  "payment_intent": null,\n  "payment_link": null,\n  "payment_method_collection": "always",\n  "payment_method_configuration_details": null,\n  "payment_method_options": {\n    "card": {\n      "request_three_d_secure": "automatic"\n    }\n  },\n  "payment_method_types": [\n    "card"\n  ],\n  "payment_status": "unpaid",\n  "permissions": null,\n  "phone_number_collection": {\n    "enabled": false\n  },\n  "recovered_from": null,\n  "saved_payment_method_options": {\n    "allow_redisplay_filters": [\n      "always"\n    ],\n    "payment_method_remove": "disabled",\n    "payment_method_save": null\n  },\n  "setup_intent": null,\n  "shipping_address_collection": null,\n  "shipping_cost": null,\n  "shipping_options": [],\n  "status": "open",\n  "submit_type": null,\n  "subscription": null,\n  "success_url": "http://localhost:3000/success?session_id={CHECKOUT_SESSION_ID}",\n  "total_details": {\n    "amount_discount": 0,\n    "amount_shipping": 0,\n    "amount_tax": 0\n  },\n  "ui_mode": "hosted",\n  "url": "https://checkout.stripe.com/c/pay/cs_test_a1O1u7QGnd7d2ZzaRYYaUqMO4TCzD2DHD0BtuHOSPDlOs1GA4CvnJNfmhG#fidkdWxOYHwnPyd1blpxYHZxWjA0V3JsX2I1PDVjRm5yTkd%2FVnRJMTc0c2RWPFFAcTFzM0NxZ1RWV01HRmpiYk41aEJoZzRVUl9%2FcGhuPGNGfF89T21mZHVtc00wQ2xsXXRKUT02XDxjSnFpNTVcQFVnXDd%2FRicpJ2N3amhWYHdzYHcnP3F3cGApJ2lkfGpwcVF8dWAnPyd2bGtiaWBabHFgaCcpJ2BrZGdpYFVpZGZgbWppYWB3dic%2FcXdwYHgl",\n  "wallet_options": null\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_Zd1nmttnM2dktD message='Dashboard link for request'
message='Request to Stripe api' method=get url=https://api.stripe.com/v1/subscriptions/sub_1O1u7QGnd7dABCD12345
api_version=2025-07-30.basil message='Post details' post_data=
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "GET /v1/subscriptions/sub_1O1u7QGnd7dABCD12345 HTTP/1.1" 404 343
message='Stripe API response' path=https://api.stripe.com/v1/subscriptions/sub_1O1u7QGnd7dABCD12345 response_code=404
body='{\n  "error": {\n    "code": "resource_missing",\n    "doc_url": "https://stripe.com/docs/error-codes/resource-missing",\n    "message": "No such subscription: \'sub_1O1u7QGnd7dABCD12345\'",\n    "param": "id",\n    "request_log_url": "https://dashboard.stripe.com/test/logs/req_D4ExdJkxN43ZNx?t=1755526624",\n    "type": "invalid_request_error"\n  }\n}\n' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_D4ExdJkxN43ZNx message='Dashboard link for request'
error_code=resource_missing error_message="No such subscription: 'sub_1O1u7QGnd7dABCD12345'" error_param=id error_type=invalid_request_error message='Stripe v1 API error received'
Internal Server Error: /api/payments/webhook/
Traceback (most recent call last):
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\kaisa\magictale\subscription\webhooks.py", line 160, in stripe_webhook
    stripe_sub = stripe.Subscription.retrieve(subscription_id)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_subscription.py", line 2953, in retrieve
    instance.refresh()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_resource.py", line 38, in refresh
    return self._request_and_refresh("get", self.instance_url())
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_resource.py", line 128, in _request_and_refresh
    obj = StripeObject._request(
        self,
    ...<4 lines>...
        usage=usage,
    )
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_stripe_object.py", line 406, in _request
    return self._requestor.request(
           ~~~~~~~~~~~~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<4 lines>...
        usage=usage,
        ^^^^^^^^^^^^
    )
    ^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 197, in request
    resp = requestor._interpret_response(rbody, rcode, rheaders, api_mode)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 853, in _interpret_response
    self.handle_error_response(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        rbody, rcode, resp.data, rheaders, api_mode
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 336, in handle_error_response
    raise err
stripe._error.InvalidRequestError: Request req_D4ExdJkxN43ZNx: No such subscription: 'sub_1O1u7QGnd7dABCD12345'
message='Request to Stripe api' method=get url=https://api.stripe.com/v1/subscriptions/sub_1RxTpf090fCkwKBzFpZmKkEv
api_version=2025-07-30.basil message='Post details' post_data=
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "GET /v1/subscriptions/sub_1RxTpf090fCkwKBzFpZmKkEv HTTP/1.1" 200 4576
message='Stripe API response' path=https://api.stripe.com/v1/subscriptions/sub_1RxTpf090fCkwKBzFpZmKkEv response_code=200
body='{\n  "id": "sub_1RxTpf090fCkwKBzFpZmKkEv",\n  "object": "subscription",\n  "application": null,\n  "application_fee_percent": null,\n  "automatic_tax": {\n    "disabled_reason": null,\n    "enabled": false,\n    "liability": null\n  },\n  "billing_cycle_anchor": 1756736082,\n  "billing_cycle_anchor_config": null,\n  "billing_mode": {\n    "type": "classic"\n  },\n  "billing_thresholds": null,\n  "cancel_at": null,\n  "cancel_at_period_end": false,\n  "canceled_at": null,\n  "cancellation_details": {\n    "comment": null,\n    "feedback": null,\n    "reason": null\n  },\n  "collection_method": "charge_automatically",\n  "created": 1755526482,\n  "currency": "usd",\n  "customer": "cus_StGLAD8xMjEliF",\n  "days_until_due": null,\n  "default_payment_method": "pm_1RxTpd090fCkwKBzngqoLXtN",\n  "default_source": null,\n  "default_tax_rates": [],\n  "description": null,\n  "discounts": [],\n  "ended_at": null,\n  "invoice_settings": {\n    "account_tax_ids": null,\n    "issuer": {\n      "type": "self"\n    }\n  },\n  "items": {\n    "object": "list",\n    "data": [\n      {\n        "id": "si_StGM197v45Yfsb",\n        "object": "subscription_item",\n        "billing_thresholds": null,\n        "created": 1755526482,\n        "current_period_end": 1756736082,\n        "current_period_start": 1755526482,\n        "discounts": [],\n        "metadata": {},\n        "plan": {\n          "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n          "object": "plan",\n          "active": true,\n          "amount": 499,\n          "amount_decimal": "499",\n          "billing_scheme": "per_unit",\n          "created": 1755382872,\n          "currency": "usd",\n          "interval": "month",\n          "interval_count": 1,\n          "livemode": false,\n          "metadata": {},\n          "meter": null,\n          "nickname": null,\n          "product": "prod_Ssdk9je3fj3io3",\n          "tiers_mode": null,\n          "transform_usage": null,\n          "trial_period_days": null,\n          "usage_type": "licensed"\n        },\n        "price": {\n          "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n          "object": "price",\n          "active": true,\n          "billing_scheme": "per_unit",\n          "created": 1755382872,\n          "currency": "usd",\n          "custom_unit_amount": null,\n          "livemode": false,\n          "lookup_key": null,\n          "metadata": {},\n          "nickname": null,\n          "product": "prod_Ssdk9je3fj3io3",\n          "recurring": {\n            "interval": "month",\n            "interval_count": 1,\n            "meter": null,\n            "trial_period_days": null,\n            "usage_type": "licensed"\n          },\n          "tax_behavior": "unspecified",\n          "tiers_mode": null,\n          "transform_quantity": null,\n          "type": "recurring",\n          "unit_amount": 499,\n          "unit_amount_decimal": "499"\n        },\n        "quantity": 1,\n        "subscription": "sub_1RxTpf090fCkwKBzFpZmKkEv",\n        "tax_rates": []\n      }\n    ],\n    "has_more": false,\n    "total_count": 1,\n    "url": "/v1/subscription_items?subscription=sub_1RxTpf090fCkwKBzFpZmKkEv"\n  },\n  "latest_invoice": "in_1RxTpe090fCkwKBztpMEbH1y",\n  "livemode": false,\n  "metadata": {},\n  "next_pending_invoice_item_invoice": null,\n  "on_behalf_of": null,\n  "pause_collection": null,\n  "payment_settings": {\n    "payment_method_options": {\n      "acss_debit": null,\n      "bancontact": null,\n      "card": {\n        "network": null,\n        "request_three_d_secure": "automatic"\n      },\n      "customer_balance": null,\n      "konbini": null,\n      "sepa_debit": null,\n      "us_bank_account": null\n    },\n    "payment_method_types": [\n      "card"\n    ],\n    "save_default_payment_method": "off"\n  },\n  "pending_invoice_item_interval": null,\n  "pending_setup_intent": null,\n  "pending_update": null,\n  "plan": {\n    "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n    "object": "plan",\n    "active": true,\n    "amount": 499,\n    "amount_decimal": "499",\n    "billing_scheme": "per_unit",\n    "created": 1755382872,\n    "currency": "usd",\n    "interval": "month",\n    "interval_count": 1,\n    "livemode": false,\n    "metadata": {},\n    "meter": null,\n    "nickname": null,\n    "product": "prod_Ssdk9je3fj3io3",\n    "tiers_mode": null,\n    "transform_usage": null,\n    "trial_period_days": null,\n    "usage_type": "licensed"\n  },\n  "quantity": 1,\n  "schedule": null,\n  "start_date": 1755526482,\n  "status": "trialing",\n  "test_clock": null,\n  "transfer_data": null,\n  "trial_end": 1756736082,\n  "trial_settings": {\n    "end_behavior": {\n      "missing_payment_method": "create_invoice"\n    }\n  },\n  "trial_start": 1755526482\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_OLQY0FZUoueUBH message='Dashboard link for request'
Watching for file changes with StatReloader
Watching for file changes with StatReloader
Not Found: /
Not Found: /favicon.ico
Watching for file changes with StatReloader
Not Found: /api/password/change/
Not Found: /api/password-change/
Starting new HTTPS connection (1): api.pwnedpasswords.com:443
https://api.pwnedpasswords.com:443 "GET /range/CFF50 HTTP/1.1" 200 None
Unauthorized: /api/password-reset/
Unauthorized: /api/login/
Unauthorized: /api/password-reset/
Unauthorized: /api/password-reset/
Not Found: /favicon.ico
Unauthorized: /api/password-reset/confirm/
Starting new HTTPS connection (1): api.pwnedpasswords.com:443
https://api.pwnedpasswords.com:443 "GET /range/E0AC4 HTTP/1.1" 200 None
Importing AvifImagePlugin
Importing BlpImagePlugin
Importing BmpImagePlugin
Importing BufrStubImagePlugin
Importing CurImagePlugin
Importing DcxImagePlugin
Importing DdsImagePlugin
Importing EpsImagePlugin
Importing FitsImagePlugin
Importing FliImagePlugin
Importing FpxImagePlugin
Image: failed to import FpxImagePlugin: No module named 'olefile'
Importing FtexImagePlugin
Importing GbrImagePlugin
Importing GifImagePlugin
Importing GribStubImagePlugin
Importing Hdf5StubImagePlugin
Importing IcnsImagePlugin
Importing IcoImagePlugin
Importing ImImagePlugin
Importing ImtImagePlugin
Importing IptcImagePlugin
Importing JpegImagePlugin
Importing Jpeg2KImagePlugin
Importing McIdasImagePlugin
Importing MicImagePlugin
Image: failed to import MicImagePlugin: No module named 'olefile'
Importing MpegImagePlugin
Importing MpoImagePlugin
Importing MspImagePlugin
Importing PalmImagePlugin
Importing PcdImagePlugin
Importing PcxImagePlugin
Importing PdfImagePlugin
Importing PixarImagePlugin
Importing PngImagePlugin
Importing PpmImagePlugin
Importing PsdImagePlugin
Importing QoiImagePlugin
Importing SgiImagePlugin
Importing SpiderImagePlugin
Importing SunImagePlugin
Importing TgaImagePlugin
Importing TiffImagePlugin
Importing WebPImagePlugin
Importing WmfImagePlugin
Importing XbmImagePlugin
Importing XpmImagePlugin
Importing XVThumbImagePlugin
Not Found: /favicon.ico
Bad Request: /api/email-change/confirm/
Bad Request: /api/email-change/confirm/
Bad Request: /api/email-change/
Bad Request: /api/email-change/confirm/
Bad Request: /api/email-change/confirm/
Not Found: /
Not Found: /favicon.ico
Bad Request: /api/email-change/confirm/
Watching for file changes with StatReloader
Not Found: /
Starting new HTTPS connection (1): api.pwnedpasswords.com:443
https://api.pwnedpasswords.com:443 "GET /range/CFF50 HTTP/1.1" 200 None
Starting new HTTPS connection (1): api.pwnedpasswords.com:443
https://api.pwnedpasswords.com:443 "GET /range/E0AC4 HTTP/1.1" 200 None
Importing AvifImagePlugin
Importing BlpImagePlugin
Importing BmpImagePlugin
Importing BufrStubImagePlugin
Importing CurImagePlugin
Importing DcxImagePlugin
Importing DdsImagePlugin
Importing EpsImagePlugin
Importing FitsImagePlugin
Importing FliImagePlugin
Importing FpxImagePlugin
Image: failed to import FpxImagePlugin: No module named 'olefile'
Importing FtexImagePlugin
Importing GbrImagePlugin
Importing GifImagePlugin
Importing GribStubImagePlugin
Importing Hdf5StubImagePlugin
Importing IcnsImagePlugin
Importing IcoImagePlugin
Importing ImImagePlugin
Importing ImtImagePlugin
Importing IptcImagePlugin
Importing JpegImagePlugin
Importing Jpeg2KImagePlugin
Importing McIdasImagePlugin
Importing MicImagePlugin
Image: failed to import MicImagePlugin: No module named 'olefile'
Importing MpegImagePlugin
Importing MpoImagePlugin
Importing MspImagePlugin
Importing PalmImagePlugin
Importing PcdImagePlugin
Importing PcxImagePlugin
Importing PdfImagePlugin
Importing PixarImagePlugin
Importing PngImagePlugin
Importing PpmImagePlugin
Importing PsdImagePlugin
Importing QoiImagePlugin
Importing SgiImagePlugin
Importing SpiderImagePlugin
Importing SunImagePlugin
Importing TgaImagePlugin
Importing TiffImagePlugin
Importing WebPImagePlugin
Importing WmfImagePlugin
Importing XbmImagePlugin
Importing XpmImagePlugin
Importing XVThumbImagePlugin
Bad Request: /api/email-change/
message='Request to Stripe api' method=post url=https://api.stripe.com/v1/customers
api_version=2025-07-30.basil message='Post details' post_data=email=18192103277%40cse.bubt.edu.bd
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "POST /v1/customers HTTP/1.1" 200 639
message='Stripe API response' path=https://api.stripe.com/v1/customers response_code=200
body='{\n  "id": "cus_StK5bgJdN6XMlM",\n  "object": "customer",\n  "address": null,\n  "balance": 0,\n  "created": 1755540352,\n  "currency": null,\n  "default_source": null,\n  "delinquent": false,\n  "description": null,\n  "discount": null,\n  "email": "18192103277@cse.bubt.edu.bd",\n  "invoice_prefix": "C4HXHZQX",\n  "invoice_settings": {\n    "custom_fields": null,\n    "default_payment_method": null,\n    "footer": null,\n    "rendering_options": null\n  },\n  "livemode": false,\n  "metadata": {},\n  "name": null,\n  "next_invoice_sequence": 1,\n  "phone": null,\n  "preferred_locales": [],\n  "shipping": null,\n  "tax_exempt": "none",\n  "test_clock": null\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_i7xY4CHDN70YMU message='Dashboard link for request'
message='Request to Stripe api' method=post url=https://api.stripe.com/v1/checkout/sessions
api_version=2025-07-30.basil message='Post details' post_data=payment_method_types[0]=card&customer=cus_StK5bgJdN6XMlM&line_items[0][price]=price_1RwsTM090fCkwKBzzGwDxzmH&line_items[0][quantity]=1&mode=subscription&subscription_data[trial_period_days]=14&success_url=http%3A%2F%2Flocalhost%3A3000%2Fsuccess%3Fsession_id%3D%7BCHECKOUT_SESSION_ID%7D&cancel_url=http%3A%2F%2Flocalhost%3A3000%2Fcancel
https://api.stripe.com:443 "POST /v1/checkout/sessions HTTP/1.1" 200 2721
message='Stripe API response' path=https://api.stripe.com/v1/checkout/sessions response_code=200
body='{\n  "id": "cs_test_a1srmasuThezMt34LnHJL3dK6HgOO5jD2WBax6MOQ9k7dxQAOQt6OvElAZ",\n  "object": "checkout.session",\n  "adaptive_pricing": {\n    "enabled": false\n  },\n  "after_expiration": null,\n  "allow_promotion_codes": null,\n  "amount_subtotal": 0,\n  "amount_total": 0,\n  "automatic_tax": {\n    "enabled": false,\n    "liability": null,\n    "provider": null,\n    "status": null\n  },\n  "billing_address_collection": null,\n  "cancel_url": "http://localhost:3000/cancel",\n  "client_reference_id": null,\n  "client_secret": null,\n  "collected_information": {\n    "shipping_details": null\n  },\n  "consent": null,\n  "consent_collection": null,\n  "created": 1755540352,\n  "currency": "usd",\n  "currency_conversion": null,\n  "custom_fields": [],\n  "custom_text": {\n    "after_submit": null,\n    "shipping_address": null,\n    "submit": null,\n    "terms_of_service_acceptance": null\n  },\n  "customer": "cus_StK5bgJdN6XMlM",\n  "customer_creation": null,\n  "customer_details": {\n    "address": null,\n    "email": "18192103277@cse.bubt.edu.bd",\n    "name": null,\n    "phone": null,\n    "tax_exempt": "none",\n    "tax_ids": null\n  },\n  "customer_email": null,\n  "discounts": [],\n  "expires_at": 1755626752,\n  "invoice": null,\n  "invoice_creation": null,\n  "livemode": false,\n  "locale": null,\n  "metadata": {},\n  "mode": "subscription",\n  "origin_context": null,\n  "payment_intent": null,\n  "payment_link": null,\n  "payment_method_collection": "always",\n  "payment_method_configuration_details": null,\n  "payment_method_options": {\n    "card": {\n      "request_three_d_secure": "automatic"\n    }\n  },\n  "payment_method_types": [\n    "card"\n  ],\n  "payment_status": "unpaid",\n  "permissions": null,\n  "phone_number_collection": {\n    "enabled": false\n  },\n  "recovered_from": null,\n  "saved_payment_method_options": {\n    "allow_redisplay_filters": [\n      "always"\n    ],\n    "payment_method_remove": "disabled",\n    "payment_method_save": null\n  },\n  "setup_intent": null,\n  "shipping_address_collection": null,\n  "shipping_cost": null,\n  "shipping_options": [],\n  "status": "open",\n  "submit_type": null,\n  "subscription": null,\n  "success_url": "http://localhost:3000/success?session_id={CHECKOUT_SESSION_ID}",\n  "total_details": {\n    "amount_discount": 0,\n    "amount_shipping": 0,\n    "amount_tax": 0\n  },\n  "ui_mode": "hosted",\n  "url": "https://checkout.stripe.com/c/pay/cs_test_a1srmasuThezMt34LnHJL3dK6HgOO5jD2WBax6MOQ9k7dxQAOQt6OvElAZ#fidkdWxOYHwnPyd1blpxYHZxWjA0V3JsX2I1PDVjRm5yTkd%2FVnRJMTc0c2RWPFFAcTFzM0NxZ1RWV01HRmpiYk41aEJoZzRVUl9%2FcGhuPGNGfF89T21mZHVtc00wQ2xsXXRKUT02XDxjSnFpNTVcQFVnXDd%2FRicpJ2N3amhWYHdzYHcnP3F3cGApJ2lkfGpwcVF8dWAnPyd2bGtiaWBabHFgaCcpJ2BrZGdpYFVpZGZgbWppYWB3dic%2FcXdwYHgl",\n  "wallet_options": null\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_y39jklOeJQGAs7 message='Dashboard link for request'
message='Request to Stripe api' method=get url=https://api.stripe.com/v1/subscriptions/sub_1P5t4v090fCkwKBzabcdefgh
api_version=2025-07-30.basil message='Post details' post_data=
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "GET /v1/subscriptions/sub_1P5t4v090fCkwKBzabcdefgh HTTP/1.1" 404 347
message='Stripe API response' path=https://api.stripe.com/v1/subscriptions/sub_1P5t4v090fCkwKBzabcdefgh response_code=404
body='{\n  "error": {\n    "code": "resource_missing",\n    "doc_url": "https://stripe.com/docs/error-codes/resource-missing",\n    "message": "No such subscription: \'sub_1P5t4v090fCkwKBzabcdefgh\'",\n    "param": "id",\n    "request_log_url": "https://dashboard.stripe.com/test/logs/req_4dCOJMPqvjIAC0?t=1755540469",\n    "type": "invalid_request_error"\n  }\n}\n' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_4dCOJMPqvjIAC0 message='Dashboard link for request'
error_code=resource_missing error_message="No such subscription: 'sub_1P5t4v090fCkwKBzabcdefgh'" error_param=id error_type=invalid_request_error message='Stripe v1 API error received'
Internal Server Error: /api/payments/webhook/
Traceback (most recent call last):
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\kaisa\magictale\subscription\webhooks.py", line 160, in stripe_webhook
    stripe_sub = stripe.Subscription.retrieve(subscription_id)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_subscription.py", line 2953, in retrieve
    instance.refresh()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_resource.py", line 38, in refresh
    return self._request_and_refresh("get", self.instance_url())
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_resource.py", line 128, in _request_and_refresh
    obj = StripeObject._request(
        self,
    ...<4 lines>...
        usage=usage,
    )
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_stripe_object.py", line 406, in _request
    return self._requestor.request(
           ~~~~~~~~~~~~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<4 lines>...
        usage=usage,
        ^^^^^^^^^^^^
    )
    ^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 197, in request
    resp = requestor._interpret_response(rbody, rcode, rheaders, api_mode)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 853, in _interpret_response
    self.handle_error_response(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        rbody, rcode, resp.data, rheaders, api_mode
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 336, in handle_error_response
    raise err
stripe._error.InvalidRequestError: Request req_4dCOJMPqvjIAC0: No such subscription: 'sub_1P5t4v090fCkwKBzabcdefgh'
message='Request to Stripe api' method=get url=https://api.stripe.com/v1/subscriptions/sub_1P5t4v090fCkwKBzabcdefgh
api_version=2025-07-30.basil message='Post details' post_data=
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "GET /v1/subscriptions/sub_1P5t4v090fCkwKBzabcdefgh HTTP/1.1" 404 347
message='Stripe API response' path=https://api.stripe.com/v1/subscriptions/sub_1P5t4v090fCkwKBzabcdefgh response_code=404
body='{\n  "error": {\n    "code": "resource_missing",\n    "doc_url": "https://stripe.com/docs/error-codes/resource-missing",\n    "message": "No such subscription: \'sub_1P5t4v090fCkwKBzabcdefgh\'",\n    "param": "id",\n    "request_log_url": "https://dashboard.stripe.com/test/logs/req_NYnF5hKEqzHIh1?t=1755540567",\n    "type": "invalid_request_error"\n  }\n}\n' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_NYnF5hKEqzHIh1 message='Dashboard link for request'
error_code=resource_missing error_message="No such subscription: 'sub_1P5t4v090fCkwKBzabcdefgh'" error_param=id error_type=invalid_request_error message='Stripe v1 API error received'
Internal Server Error: /api/payments/webhook/
Traceback (most recent call last):
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\kaisa\magictale\subscription\webhooks.py", line 160, in stripe_webhook
    stripe_sub = stripe.Subscription.retrieve(subscription_id)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_subscription.py", line 2953, in retrieve
    instance.refresh()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_resource.py", line 38, in refresh
    return self._request_and_refresh("get", self.instance_url())
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_resource.py", line 128, in _request_and_refresh
    obj = StripeObject._request(
        self,
    ...<4 lines>...
        usage=usage,
    )
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_stripe_object.py", line 406, in _request
    return self._requestor.request(
           ~~~~~~~~~~~~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<4 lines>...
        usage=usage,
        ^^^^^^^^^^^^
    )
    ^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 197, in request
    resp = requestor._interpret_response(rbody, rcode, rheaders, api_mode)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 853, in _interpret_response
    self.handle_error_response(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        rbody, rcode, resp.data, rheaders, api_mode
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 336, in handle_error_response
    raise err
stripe._error.InvalidRequestError: Request req_NYnF5hKEqzHIh1: No such subscription: 'sub_1P5t4v090fCkwKBzabcdefgh'
message='Request to Stripe api' method=post url=https://api.stripe.com/v1/customers
api_version=2025-07-30.basil message='Post details' post_data=email=18192103277%40cse.bubt.edu.bd
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "POST /v1/customers HTTP/1.1" 200 639
message='Stripe API response' path=https://api.stripe.com/v1/customers response_code=200
body='{\n  "id": "cus_StKBEC9nEeUx97",\n  "object": "customer",\n  "address": null,\n  "balance": 0,\n  "created": 1755540700,\n  "currency": null,\n  "default_source": null,\n  "delinquent": false,\n  "description": null,\n  "discount": null,\n  "email": "18192103277@cse.bubt.edu.bd",\n  "invoice_prefix": "M3KCDREK",\n  "invoice_settings": {\n    "custom_fields": null,\n    "default_payment_method": null,\n    "footer": null,\n    "rendering_options": null\n  },\n  "livemode": false,\n  "metadata": {},\n  "name": null,\n  "next_invoice_sequence": 1,\n  "phone": null,\n  "preferred_locales": [],\n  "shipping": null,\n  "tax_exempt": "none",\n  "test_clock": null\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_Wb2RQ67SIIgJD0 message='Dashboard link for request'
message='Request to Stripe api' method=post url=https://api.stripe.com/v1/checkout/sessions
api_version=2025-07-30.basil message='Post details' post_data=payment_method_types[0]=card&customer=cus_StKBEC9nEeUx97&line_items[0][price]=price_1RwsTM090fCkwKBzzGwDxzmH&line_items[0][quantity]=1&mode=subscription&subscription_data[trial_period_days]=14&success_url=http%3A%2F%2Flocalhost%3A3000%2Fsuccess%3Fsession_id%3D%7BCHECKOUT_SESSION_ID%7D&cancel_url=http%3A%2F%2Flocalhost%3A3000%2Fcancel
https://api.stripe.com:443 "POST /v1/checkout/sessions HTTP/1.1" 200 2721
message='Stripe API response' path=https://api.stripe.com/v1/checkout/sessions response_code=200
body='{\n  "id": "cs_test_a1yIn25bve6PC76HoXCTYQpTfiDLL3W1ojkU3GFKmkkZ5zlY9NMJGn9PLw",\n  "object": "checkout.session",\n  "adaptive_pricing": {\n    "enabled": false\n  },\n  "after_expiration": null,\n  "allow_promotion_codes": null,\n  "amount_subtotal": 0,\n  "amount_total": 0,\n  "automatic_tax": {\n    "enabled": false,\n    "liability": null,\n    "provider": null,\n    "status": null\n  },\n  "billing_address_collection": null,\n  "cancel_url": "http://localhost:3000/cancel",\n  "client_reference_id": null,\n  "client_secret": null,\n  "collected_information": {\n    "shipping_details": null\n  },\n  "consent": null,\n  "consent_collection": null,\n  "created": 1755540701,\n  "currency": "usd",\n  "currency_conversion": null,\n  "custom_fields": [],\n  "custom_text": {\n    "after_submit": null,\n    "shipping_address": null,\n    "submit": null,\n    "terms_of_service_acceptance": null\n  },\n  "customer": "cus_StKBEC9nEeUx97",\n  "customer_creation": null,\n  "customer_details": {\n    "address": null,\n    "email": "18192103277@cse.bubt.edu.bd",\n    "name": null,\n    "phone": null,\n    "tax_exempt": "none",\n    "tax_ids": null\n  },\n  "customer_email": null,\n  "discounts": [],\n  "expires_at": 1755627101,\n  "invoice": null,\n  "invoice_creation": null,\n  "livemode": false,\n  "locale": null,\n  "metadata": {},\n  "mode": "subscription",\n  "origin_context": null,\n  "payment_intent": null,\n  "payment_link": null,\n  "payment_method_collection": "always",\n  "payment_method_configuration_details": null,\n  "payment_method_options": {\n    "card": {\n      "request_three_d_secure": "automatic"\n    }\n  },\n  "payment_method_types": [\n    "card"\n  ],\n  "payment_status": "unpaid",\n  "permissions": null,\n  "phone_number_collection": {\n    "enabled": false\n  },\n  "recovered_from": null,\n  "saved_payment_method_options": {\n    "allow_redisplay_filters": [\n      "always"\n    ],\n    "payment_method_remove": "disabled",\n    "payment_method_save": null\n  },\n  "setup_intent": null,\n  "shipping_address_collection": null,\n  "shipping_cost": null,\n  "shipping_options": [],\n  "status": "open",\n  "submit_type": null,\n  "subscription": null,\n  "success_url": "http://localhost:3000/success?session_id={CHECKOUT_SESSION_ID}",\n  "total_details": {\n    "amount_discount": 0,\n    "amount_shipping": 0,\n    "amount_tax": 0\n  },\n  "ui_mode": "hosted",\n  "url": "https://checkout.stripe.com/c/pay/cs_test_a1yIn25bve6PC76HoXCTYQpTfiDLL3W1ojkU3GFKmkkZ5zlY9NMJGn9PLw#fidkdWxOYHwnPyd1blpxYHZxWjA0V3JsX2I1PDVjRm5yTkd%2FVnRJMTc0c2RWPFFAcTFzM0NxZ1RWV01HRmpiYk41aEJoZzRVUl9%2FcGhuPGNGfF89T21mZHVtc00wQ2xsXXRKUT02XDxjSnFpNTVcQFVnXDd%2FRicpJ2N3amhWYHdzYHcnP3F3cGApJ2lkfGpwcVF8dWAnPyd2bGtiaWBabHFgaCcpJ2BrZGdpYFVpZGZgbWppYWB3dic%2FcXdwYHgl",\n  "wallet_options": null\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_GKrrOcWsWkyOLL message='Dashboard link for request'
message='Request to Stripe api' method=get url=https://api.stripe.com/v1/subscriptions/sub_REPLACE_WITH_YOUR_REAL_SUBSCRIPTION_ID
api_version=2025-07-30.basil message='Post details' post_data=
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "GET /v1/subscriptions/sub_REPLACE_WITH_YOUR_REAL_SUBSCRIPTION_ID HTTP/1.1" 404 361
message='Stripe API response' path=https://api.stripe.com/v1/subscriptions/sub_REPLACE_WITH_YOUR_REAL_SUBSCRIPTION_ID response_code=404
body='{\n  "error": {\n    "code": "resource_missing",\n    "doc_url": "https://stripe.com/docs/error-codes/resource-missing",\n    "message": "No such subscription: \'sub_REPLACE_WITH_YOUR_REAL_SUBSCRIPTION_ID\'",\n    "param": "id",\n    "request_log_url": "https://dashboard.stripe.com/test/logs/req_ML7cWrYZGFnVf2?t=1755541016",\n    "type": "invalid_request_error"\n  }\n}\n' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_ML7cWrYZGFnVf2 message='Dashboard link for request'
error_code=resource_missing error_message="No such subscription: 'sub_REPLACE_WITH_YOUR_REAL_SUBSCRIPTION_ID'" error_param=id error_type=invalid_request_error message='Stripe v1 API error received'
Internal Server Error: /api/payments/webhook/
Traceback (most recent call last):
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\kaisa\magictale\subscription\webhooks.py", line 160, in stripe_webhook
    stripe_sub = stripe.Subscription.retrieve(subscription_id)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_subscription.py", line 2953, in retrieve
    instance.refresh()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_resource.py", line 38, in refresh
    return self._request_and_refresh("get", self.instance_url())
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_resource.py", line 128, in _request_and_refresh
    obj = StripeObject._request(
        self,
    ...<4 lines>...
        usage=usage,
    )
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_stripe_object.py", line 406, in _request
    return self._requestor.request(
           ~~~~~~~~~~~~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<4 lines>...
        usage=usage,
        ^^^^^^^^^^^^
    )
    ^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 197, in request
    resp = requestor._interpret_response(rbody, rcode, rheaders, api_mode)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 853, in _interpret_response
    self.handle_error_response(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        rbody, rcode, resp.data, rheaders, api_mode
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\stripe\_api_requestor.py", line 336, in handle_error_response
    raise err
stripe._error.InvalidRequestError: Request req_ML7cWrYZGFnVf2: No such subscription: 'sub_REPLACE_WITH_YOUR_REAL_SUBSCRIPTION_ID'
message='Request to Stripe api' method=get url=https://api.stripe.com/v1/subscriptions/sub_1RxXXH090fCkwKBzPsv2NC74
api_version=2025-07-30.basil message='Post details' post_data=
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "GET /v1/subscriptions/sub_1RxXXH090fCkwKBzPsv2NC74 HTTP/1.1" 200 4576
message='Stripe API response' path=https://api.stripe.com/v1/subscriptions/sub_1RxXXH090fCkwKBzPsv2NC74 response_code=200
body='{\n  "id": "sub_1RxXXH090fCkwKBzPsv2NC74",\n  "object": "subscription",\n  "application": null,\n  "application_fee_percent": null,\n  "automatic_tax": {\n    "disabled_reason": null,\n    "enabled": false,\n    "liability": null\n  },\n  "billing_cycle_anchor": 1756750318,\n  "billing_cycle_anchor_config": null,\n  "billing_mode": {\n    "type": "classic"\n  },\n  "billing_thresholds": null,\n  "cancel_at": null,\n  "cancel_at_period_end": false,\n  "canceled_at": null,\n  "cancellation_details": {\n    "comment": null,\n    "feedback": null,\n    "reason": null\n  },\n  "collection_method": "charge_automatically",\n  "created": 1755540718,\n  "currency": "usd",\n  "customer": "cus_StKBEC9nEeUx97",\n  "days_until_due": null,\n  "default_payment_method": "pm_1RxXXF090fCkwKBzDGZlYXUg",\n  "default_source": null,\n  "default_tax_rates": [],\n  "description": null,\n  "discounts": [],\n  "ended_at": null,\n  "invoice_settings": {\n    "account_tax_ids": null,\n    "issuer": {\n      "type": "self"\n    }\n  },\n  "items": {\n    "object": "list",\n    "data": [\n      {\n        "id": "si_StKBn4fZDoEvI1",\n        "object": "subscription_item",\n        "billing_thresholds": null,\n        "created": 1755540718,\n        "current_period_end": 1756750318,\n        "current_period_start": 1755540718,\n        "discounts": [],\n        "metadata": {},\n        "plan": {\n          "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n          "object": "plan",\n          "active": true,\n          "amount": 499,\n          "amount_decimal": "499",\n          "billing_scheme": "per_unit",\n          "created": 1755382872,\n          "currency": "usd",\n          "interval": "month",\n          "interval_count": 1,\n          "livemode": false,\n          "metadata": {},\n          "meter": null,\n          "nickname": null,\n          "product": "prod_Ssdk9je3fj3io3",\n          "tiers_mode": null,\n          "transform_usage": null,\n          "trial_period_days": null,\n          "usage_type": "licensed"\n        },\n        "price": {\n          "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n          "object": "price",\n          "active": true,\n          "billing_scheme": "per_unit",\n          "created": 1755382872,\n          "currency": "usd",\n          "custom_unit_amount": null,\n          "livemode": false,\n          "lookup_key": null,\n          "metadata": {},\n          "nickname": null,\n          "product": "prod_Ssdk9je3fj3io3",\n          "recurring": {\n            "interval": "month",\n            "interval_count": 1,\n            "meter": null,\n            "trial_period_days": null,\n            "usage_type": "licensed"\n          },\n          "tax_behavior": "unspecified",\n          "tiers_mode": null,\n          "transform_quantity": null,\n          "type": "recurring",\n          "unit_amount": 499,\n          "unit_amount_decimal": "499"\n        },\n        "quantity": 1,\n        "subscription": "sub_1RxXXH090fCkwKBzPsv2NC74",\n        "tax_rates": []\n      }\n    ],\n    "has_more": false,\n    "total_count": 1,\n    "url": "/v1/subscription_items?subscription=sub_1RxXXH090fCkwKBzPsv2NC74"\n  },\n  "latest_invoice": "in_1RxXXG090fCkwKBzPehWpjg6",\n  "livemode": false,\n  "metadata": {},\n  "next_pending_invoice_item_invoice": null,\n  "on_behalf_of": null,\n  "pause_collection": null,\n  "payment_settings": {\n    "payment_method_options": {\n      "acss_debit": null,\n      "bancontact": null,\n      "card": {\n        "network": null,\n        "request_three_d_secure": "automatic"\n      },\n      "customer_balance": null,\n      "konbini": null,\n      "sepa_debit": null,\n      "us_bank_account": null\n    },\n    "payment_method_types": [\n      "card"\n    ],\n    "save_default_payment_method": "off"\n  },\n  "pending_invoice_item_interval": null,\n  "pending_setup_intent": null,\n  "pending_update": null,\n  "plan": {\n    "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n    "object": "plan",\n    "active": true,\n    "amount": 499,\n    "amount_decimal": "499",\n    "billing_scheme": "per_unit",\n    "created": 1755382872,\n    "currency": "usd",\n    "interval": "month",\n    "interval_count": 1,\n    "livemode": false,\n    "metadata": {},\n    "meter": null,\n    "nickname": null,\n    "product": "prod_Ssdk9je3fj3io3",\n    "tiers_mode": null,\n    "transform_usage": null,\n    "trial_period_days": null,\n    "usage_type": "licensed"\n  },\n  "quantity": 1,\n  "schedule": null,\n  "start_date": 1755540718,\n  "status": "trialing",\n  "test_clock": null,\n  "transfer_data": null,\n  "trial_end": 1756750318,\n  "trial_settings": {\n    "end_behavior": {\n      "missing_payment_method": "create_invoice"\n    }\n  },\n  "trial_start": 1755540718\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_BkSBYMTRZURjEb message='Dashboard link for request'
C:\Users\kaisa\magictale\subscription\views.py changed, reloading.
Watching for file changes with StatReloader
message='Request to Stripe api' method=post url=https://api.stripe.com/v1/customers
api_version=2025-07-30.basil message='Post details' post_data=email=18192103277%40cse.bubt.edu.bd
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "POST /v1/customers HTTP/1.1" 200 639
message='Stripe API response' path=https://api.stripe.com/v1/customers response_code=200
body='{\n  "id": "cus_StKNNpDNPsv5fX",\n  "object": "customer",\n  "address": null,\n  "balance": 0,\n  "created": 1755541421,\n  "currency": null,\n  "default_source": null,\n  "delinquent": false,\n  "description": null,\n  "discount": null,\n  "email": "18192103277@cse.bubt.edu.bd",\n  "invoice_prefix": "TV4INTKT",\n  "invoice_settings": {\n    "custom_fields": null,\n    "default_payment_method": null,\n    "footer": null,\n    "rendering_options": null\n  },\n  "livemode": false,\n  "metadata": {},\n  "name": null,\n  "next_invoice_sequence": 1,\n  "phone": null,\n  "preferred_locales": [],\n  "shipping": null,\n  "tax_exempt": "none",\n  "test_clock": null\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_rrcg8U6lnw2Tyu message='Dashboard link for request'
message='Request to Stripe api' method=post url=https://api.stripe.com/v1/checkout/sessions
api_version=2025-07-30.basil message='Post details' post_data=payment_method_types[0]=card&customer=cus_StKNNpDNPsv5fX&line_items[0][price]=price_1RwsTM090fCkwKBzzGwDxzmH&line_items[0][quantity]=1&mode=subscription&subscription_data[trial_period_days]=14&success_url=http%3A%2F%2Flocalhost%3A3000%2Fsuccess%3Fsession_id%3D%7BCHECKOUT_SESSION_ID%7D&cancel_url=http%3A%2F%2Flocalhost%3A3000%2Fcancel
https://api.stripe.com:443 "POST /v1/checkout/sessions HTTP/1.1" 200 2721
message='Stripe API response' path=https://api.stripe.com/v1/checkout/sessions response_code=200
body='{\n  "id": "cs_test_a1WoHtnYweOYNJXJLNzFt7CxL5a4pKSCJ1U6lancIE0zF2IuHdR52AreMs",\n  "object": "checkout.session",\n  "adaptive_pricing": {\n    "enabled": false\n  },\n  "after_expiration": null,\n  "allow_promotion_codes": null,\n  "amount_subtotal": 0,\n  "amount_total": 0,\n  "automatic_tax": {\n    "enabled": false,\n    "liability": null,\n    "provider": null,\n    "status": null\n  },\n  "billing_address_collection": null,\n  "cancel_url": "http://localhost:3000/cancel",\n  "client_reference_id": null,\n  "client_secret": null,\n  "collected_information": {\n    "shipping_details": null\n  },\n  "consent": null,\n  "consent_collection": null,\n  "created": 1755541422,\n  "currency": "usd",\n  "currency_conversion": null,\n  "custom_fields": [],\n  "custom_text": {\n    "after_submit": null,\n    "shipping_address": null,\n    "submit": null,\n    "terms_of_service_acceptance": null\n  },\n  "customer": "cus_StKNNpDNPsv5fX",\n  "customer_creation": null,\n  "customer_details": {\n    "address": null,\n    "email": "18192103277@cse.bubt.edu.bd",\n    "name": null,\n    "phone": null,\n    "tax_exempt": "none",\n    "tax_ids": null\n  },\n  "customer_email": null,\n  "discounts": [],\n  "expires_at": 1755627822,\n  "invoice": null,\n  "invoice_creation": null,\n  "livemode": false,\n  "locale": null,\n  "metadata": {},\n  "mode": "subscription",\n  "origin_context": null,\n  "payment_intent": null,\n  "payment_link": null,\n  "payment_method_collection": "always",\n  "payment_method_configuration_details": null,\n  "payment_method_options": {\n    "card": {\n      "request_three_d_secure": "automatic"\n    }\n  },\n  "payment_method_types": [\n    "card"\n  ],\n  "payment_status": "unpaid",\n  "permissions": null,\n  "phone_number_collection": {\n    "enabled": false\n  },\n  "recovered_from": null,\n  "saved_payment_method_options": {\n    "allow_redisplay_filters": [\n      "always"\n    ],\n    "payment_method_remove": "disabled",\n    "payment_method_save": null\n  },\n  "setup_intent": null,\n  "shipping_address_collection": null,\n  "shipping_cost": null,\n  "shipping_options": [],\n  "status": "open",\n  "submit_type": null,\n  "subscription": null,\n  "success_url": "http://localhost:3000/success?session_id={CHECKOUT_SESSION_ID}",\n  "total_details": {\n    "amount_discount": 0,\n    "amount_shipping": 0,\n    "amount_tax": 0\n  },\n  "ui_mode": "hosted",\n  "url": "https://checkout.stripe.com/c/pay/cs_test_a1WoHtnYweOYNJXJLNzFt7CxL5a4pKSCJ1U6lancIE0zF2IuHdR52AreMs#fidkdWxOYHwnPyd1blpxYHZxWjA0V3JsX2I1PDVjRm5yTkd%2FVnRJMTc0c2RWPFFAcTFzM0NxZ1RWV01HRmpiYk41aEJoZzRVUl9%2FcGhuPGNGfF89T21mZHVtc00wQ2xsXXRKUT02XDxjSnFpNTVcQFVnXDd%2FRicpJ2N3amhWYHdzYHcnP3F3cGApJ2lkfGpwcVF8dWAnPyd2bGtiaWBabHFgaCcpJ2BrZGdpYFVpZGZgbWppYWB3dic%2FcXdwYHgl",\n  "wallet_options": null\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_ji8MdZkEtP3jMg message='Dashboard link for request'
message='Request to Stripe api' method=get url=https://api.stripe.com/v1/subscriptions/sub_1RxXiq090fCkwKBzJiWg9Kfv
api_version=2025-07-30.basil message='Post details' post_data=
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "GET /v1/subscriptions/sub_1RxXiq090fCkwKBzJiWg9Kfv HTTP/1.1" 200 4576
message='Stripe API response' path=https://api.stripe.com/v1/subscriptions/sub_1RxXiq090fCkwKBzJiWg9Kfv response_code=200
body='{\n  "id": "sub_1RxXiq090fCkwKBzJiWg9Kfv",\n  "object": "subscription",\n  "application": null,\n  "application_fee_percent": null,\n  "automatic_tax": {\n    "disabled_reason": null,\n    "enabled": false,\n    "liability": null\n  },\n  "billing_cycle_anchor": 1756751035,\n  "billing_cycle_anchor_config": null,\n  "billing_mode": {\n    "type": "classic"\n  },\n  "billing_thresholds": null,\n  "cancel_at": null,\n  "cancel_at_period_end": false,\n  "canceled_at": null,\n  "cancellation_details": {\n    "comment": null,\n    "feedback": null,\n    "reason": null\n  },\n  "collection_method": "charge_automatically",\n  "created": 1755541435,\n  "currency": "usd",\n  "customer": "cus_StKNNpDNPsv5fX",\n  "days_until_due": null,\n  "default_payment_method": "pm_1RxXio090fCkwKBzl4mc4SxB",\n  "default_source": null,\n  "default_tax_rates": [],\n  "description": null,\n  "discounts": [],\n  "ended_at": null,\n  "invoice_settings": {\n    "account_tax_ids": null,\n    "issuer": {\n      "type": "self"\n    }\n  },\n  "items": {\n    "object": "list",\n    "data": [\n      {\n        "id": "si_StKN3Ke4hhiaeo",\n        "object": "subscription_item",\n        "billing_thresholds": null,\n        "created": 1755541435,\n        "current_period_end": 1756751035,\n        "current_period_start": 1755541435,\n        "discounts": [],\n        "metadata": {},\n        "plan": {\n          "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n          "object": "plan",\n          "active": true,\n          "amount": 499,\n          "amount_decimal": "499",\n          "billing_scheme": "per_unit",\n          "created": 1755382872,\n          "currency": "usd",\n          "interval": "month",\n          "interval_count": 1,\n          "livemode": false,\n          "metadata": {},\n          "meter": null,\n          "nickname": null,\n          "product": "prod_Ssdk9je3fj3io3",\n          "tiers_mode": null,\n          "transform_usage": null,\n          "trial_period_days": null,\n          "usage_type": "licensed"\n        },\n        "price": {\n          "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n          "object": "price",\n          "active": true,\n          "billing_scheme": "per_unit",\n          "created": 1755382872,\n          "currency": "usd",\n          "custom_unit_amount": null,\n          "livemode": false,\n          "lookup_key": null,\n          "metadata": {},\n          "nickname": null,\n          "product": "prod_Ssdk9je3fj3io3",\n          "recurring": {\n            "interval": "month",\n            "interval_count": 1,\n            "meter": null,\n            "trial_period_days": null,\n            "usage_type": "licensed"\n          },\n          "tax_behavior": "unspecified",\n          "tiers_mode": null,\n          "transform_quantity": null,\n          "type": "recurring",\n          "unit_amount": 499,\n          "unit_amount_decimal": "499"\n        },\n        "quantity": 1,\n        "subscription": "sub_1RxXiq090fCkwKBzJiWg9Kfv",\n        "tax_rates": []\n      }\n    ],\n    "has_more": false,\n    "total_count": 1,\n    "url": "/v1/subscription_items?subscription=sub_1RxXiq090fCkwKBzJiWg9Kfv"\n  },\n  "latest_invoice": "in_1RxXip090fCkwKBz5U5Tijfw",\n  "livemode": false,\n  "metadata": {},\n  "next_pending_invoice_item_invoice": null,\n  "on_behalf_of": null,\n  "pause_collection": null,\n  "payment_settings": {\n    "payment_method_options": {\n      "acss_debit": null,\n      "bancontact": null,\n      "card": {\n        "network": null,\n        "request_three_d_secure": "automatic"\n      },\n      "customer_balance": null,\n      "konbini": null,\n      "sepa_debit": null,\n      "us_bank_account": null\n    },\n    "payment_method_types": [\n      "card"\n    ],\n    "save_default_payment_method": "off"\n  },\n  "pending_invoice_item_interval": null,\n  "pending_setup_intent": null,\n  "pending_update": null,\n  "plan": {\n    "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n    "object": "plan",\n    "active": true,\n    "amount": 499,\n    "amount_decimal": "499",\n    "billing_scheme": "per_unit",\n    "created": 1755382872,\n    "currency": "usd",\n    "interval": "month",\n    "interval_count": 1,\n    "livemode": false,\n    "metadata": {},\n    "meter": null,\n    "nickname": null,\n    "product": "prod_Ssdk9je3fj3io3",\n    "tiers_mode": null,\n    "transform_usage": null,\n    "trial_period_days": null,\n    "usage_type": "licensed"\n  },\n  "quantity": 1,\n  "schedule": null,\n  "start_date": 1755541435,\n  "status": "trialing",\n  "test_clock": null,\n  "transfer_data": null,\n  "trial_end": 1756751035,\n  "trial_settings": {\n    "end_behavior": {\n      "missing_payment_method": "create_invoice"\n    }\n  },\n  "trial_start": 1755541435\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_t1JUEguZaJaZLm message='Dashboard link for request'
Using proactor: IocpProactor
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Bad Request: /api/ai/stories/
Bad Request: /api/ai/stories/
Bad Request: /api/ai/stories/
Bad Request: /api/ai/stories/
Bad Request: /api/ai/stories/
Bad Request: /api/ai/stories/
Bad Request: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/1/start/
Using proactor: IocpProactor
Internal Server Error: /api/ai/stories/1/start/
Traceback (most recent call last):
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
        lambda: self._connect(), lambda error: self.disconnect()
    )
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **self._connection_arguments()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lambda: protocol, host, port, **kwds)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 1176, in create_connection
    raise exceptions[0]
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 1146, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
        exceptions, addrinfo, laddr_infos)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 1045, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\proactor_events.py", line 728, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\windows_events.py", line 804, in _poll
    value = callback(transferred, key, ov)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\windows_events.py", line 600, in finish_connect
    ov.getresult()
    ~~~~~~~~~~~~^^
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\rest_framework\viewsets.py", line 125, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\rest_framework\views.py", line 515, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\rest_framework\views.py", line 475, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\rest_framework\views.py", line 486, in raise_uncaught_exception
    raise exc
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\rest_framework\views.py", line 512, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\kaisa\magictale\ai\views.py", line 89, in start
    async_to_sync(run_generation_async)(project.id)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ~~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\ai\engine.py", line 150, in run_generation_async
    await _send(project_id, {"status": "running", "progress": project.progress})
  File "C:\Users\kaisa\magictale\ai\engine.py", line 58, in _send
    await layer.group_send(f"story_{project_id}", {"type": "progress", "event": event})
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\channels_redis\core.py", line 518, in group_send
    await connection.zremrangebyscore(
        key, min=0, max=int(time.time()) - self.group_expiry
    )
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
Watching for file changes with StatReloader
Bad Request: /api/ai/stories/1/start/
Unauthorized: /api/ai/stories/1/
Unauthorized: /api/login/
Unauthorized: /api/login/
Bad Request: /api/email-verify/
Unauthorized: /api/login/
Not Found: /api/ai/stories/1/start/
Forbidden: /api/ai/stories/1/start/
Forbidden: /api/ai/stories/1/start/
Not Found: /api/ai/stories/1/
Forbidden: /api/ai/stories/1/start/
C:\Users\kaisa\magictale\ai\engine.py changed, reloading.
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\authentication\views.py changed, reloading.
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\authentication\views.py changed, reloading.
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\authentication\views.py changed, reloading.
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\authentication\views.py changed, reloading.
Watching for file changes with StatReloader
Watching for file changes with StatReloader
Watching for file changes with StatReloader
Watching for file changes with StatReloader
Watching for file changes with StatReloader
Forbidden: /api/onboarding/
message='Request to Stripe api' method=post url=https://api.stripe.com/v1/customers
api_version=2025-07-30.basil message='Post details' post_data=email=kaisarfardin128%40gmail.com
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "POST /v1/customers HTTP/1.1" 200 637
message='Stripe API response' path=https://api.stripe.com/v1/customers response_code=200
body='{\n  "id": "cus_StLQy7j7DMAnDs",\n  "object": "customer",\n  "address": null,\n  "balance": 0,\n  "created": 1755545330,\n  "currency": null,\n  "default_source": null,\n  "delinquent": false,\n  "description": null,\n  "discount": null,\n  "email": "kaisarfardin128@gmail.com",\n  "invoice_prefix": "DQ0LZIN3",\n  "invoice_settings": {\n    "custom_fields": null,\n    "default_payment_method": null,\n    "footer": null,\n    "rendering_options": null\n  },\n  "livemode": false,\n  "metadata": {},\n  "name": null,\n  "next_invoice_sequence": 1,\n  "phone": null,\n  "preferred_locales": [],\n  "shipping": null,\n  "tax_exempt": "none",\n  "test_clock": null\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_h1H0FCxx9j54k6 message='Dashboard link for request'
message='Request to Stripe api' method=post url=https://api.stripe.com/v1/checkout/sessions
api_version=2025-07-30.basil message='Post details' post_data=payment_method_types[0]=card&customer=cus_StLQy7j7DMAnDs&line_items[0][price]=price_1RwsTM090fCkwKBzzGwDxzmH&line_items[0][quantity]=1&mode=subscription&subscription_data[trial_period_days]=14&success_url=http%3A%2F%2Flocalhost%3A3000%2Fsuccess%3Fsession_id%3D%7BCHECKOUT_SESSION_ID%7D&cancel_url=http%3A%2F%2Flocalhost%3A3000%2Fcancel
https://api.stripe.com:443 "POST /v1/checkout/sessions HTTP/1.1" 200 2719
message='Stripe API response' path=https://api.stripe.com/v1/checkout/sessions response_code=200
body='{\n  "id": "cs_test_a1U3Ng3wVWkLvW58ec82UbCJSLg4muNLwU2drdD1dnLNzs3t3K5mZuPulZ",\n  "object": "checkout.session",\n  "adaptive_pricing": {\n    "enabled": false\n  },\n  "after_expiration": null,\n  "allow_promotion_codes": null,\n  "amount_subtotal": 0,\n  "amount_total": 0,\n  "automatic_tax": {\n    "enabled": false,\n    "liability": null,\n    "provider": null,\n    "status": null\n  },\n  "billing_address_collection": null,\n  "cancel_url": "http://localhost:3000/cancel",\n  "client_reference_id": null,\n  "client_secret": null,\n  "collected_information": {\n    "shipping_details": null\n  },\n  "consent": null,\n  "consent_collection": null,\n  "created": 1755545331,\n  "currency": "usd",\n  "currency_conversion": null,\n  "custom_fields": [],\n  "custom_text": {\n    "after_submit": null,\n    "shipping_address": null,\n    "submit": null,\n    "terms_of_service_acceptance": null\n  },\n  "customer": "cus_StLQy7j7DMAnDs",\n  "customer_creation": null,\n  "customer_details": {\n    "address": null,\n    "email": "kaisarfardin128@gmail.com",\n    "name": null,\n    "phone": null,\n    "tax_exempt": "none",\n    "tax_ids": null\n  },\n  "customer_email": null,\n  "discounts": [],\n  "expires_at": 1755631731,\n  "invoice": null,\n  "invoice_creation": null,\n  "livemode": false,\n  "locale": null,\n  "metadata": {},\n  "mode": "subscription",\n  "origin_context": null,\n  "payment_intent": null,\n  "payment_link": null,\n  "payment_method_collection": "always",\n  "payment_method_configuration_details": null,\n  "payment_method_options": {\n    "card": {\n      "request_three_d_secure": "automatic"\n    }\n  },\n  "payment_method_types": [\n    "card"\n  ],\n  "payment_status": "unpaid",\n  "permissions": null,\n  "phone_number_collection": {\n    "enabled": false\n  },\n  "recovered_from": null,\n  "saved_payment_method_options": {\n    "allow_redisplay_filters": [\n      "always"\n    ],\n    "payment_method_remove": "disabled",\n    "payment_method_save": null\n  },\n  "setup_intent": null,\n  "shipping_address_collection": null,\n  "shipping_cost": null,\n  "shipping_options": [],\n  "status": "open",\n  "submit_type": null,\n  "subscription": null,\n  "success_url": "http://localhost:3000/success?session_id={CHECKOUT_SESSION_ID}",\n  "total_details": {\n    "amount_discount": 0,\n    "amount_shipping": 0,\n    "amount_tax": 0\n  },\n  "ui_mode": "hosted",\n  "url": "https://checkout.stripe.com/c/pay/cs_test_a1U3Ng3wVWkLvW58ec82UbCJSLg4muNLwU2drdD1dnLNzs3t3K5mZuPulZ#fidkdWxOYHwnPyd1blpxYHZxWjA0V3JsX2I1PDVjRm5yTkd%2FVnRJMTc0c2RWPFFAcTFzM0NxZ1RWV01HRmpiYk41aEJoZzRVUl9%2FcGhuPGNGfF89T21mZHVtc00wQ2xsXXRKUT02XDxjSnFpNTVcQFVnXDd%2FRicpJ2N3amhWYHdzYHcnP3F3cGApJ2lkfGpwcVF8dWAnPyd2bGtiaWBabHFgaCcpJ2BrZGdpYFVpZGZgbWppYWB3dic%2FcXdwYHgl",\n  "wallet_options": null\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_tMedOMKKN2DA3n message='Dashboard link for request'
message='Request to Stripe api' method=get url=https://api.stripe.com/v1/subscriptions/sub_1RxYjw090fCkwKBzWkSApq7j
api_version=2025-07-30.basil message='Post details' post_data=
Starting new HTTPS connection (1): api.stripe.com:443
https://api.stripe.com:443 "GET /v1/subscriptions/sub_1RxYjw090fCkwKBzWkSApq7j HTTP/1.1" 200 4576
message='Stripe API response' path=https://api.stripe.com/v1/subscriptions/sub_1RxYjw090fCkwKBzWkSApq7j response_code=200
body='{\n  "id": "sub_1RxYjw090fCkwKBzWkSApq7j",\n  "object": "subscription",\n  "application": null,\n  "application_fee_percent": null,\n  "automatic_tax": {\n    "disabled_reason": null,\n    "enabled": false,\n    "liability": null\n  },\n  "billing_cycle_anchor": 1756754947,\n  "billing_cycle_anchor_config": null,\n  "billing_mode": {\n    "type": "classic"\n  },\n  "billing_thresholds": null,\n  "cancel_at": null,\n  "cancel_at_period_end": false,\n  "canceled_at": null,\n  "cancellation_details": {\n    "comment": null,\n    "feedback": null,\n    "reason": null\n  },\n  "collection_method": "charge_automatically",\n  "created": 1755545347,\n  "currency": "usd",\n  "customer": "cus_StLQy7j7DMAnDs",\n  "days_until_due": null,\n  "default_payment_method": "pm_1RxYju090fCkwKBz3JvtkQju",\n  "default_source": null,\n  "default_tax_rates": [],\n  "description": null,\n  "discounts": [],\n  "ended_at": null,\n  "invoice_settings": {\n    "account_tax_ids": null,\n    "issuer": {\n      "type": "self"\n    }\n  },\n  "items": {\n    "object": "list",\n    "data": [\n      {\n        "id": "si_StLQsspX0hxSIL",\n        "object": "subscription_item",\n        "billing_thresholds": null,\n        "created": 1755545348,\n        "current_period_end": 1756754947,\n        "current_period_start": 1755545347,\n        "discounts": [],\n        "metadata": {},\n        "plan": {\n          "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n          "object": "plan",\n          "active": true,\n          "amount": 499,\n          "amount_decimal": "499",\n          "billing_scheme": "per_unit",\n          "created": 1755382872,\n          "currency": "usd",\n          "interval": "month",\n          "interval_count": 1,\n          "livemode": false,\n          "metadata": {},\n          "meter": null,\n          "nickname": null,\n          "product": "prod_Ssdk9je3fj3io3",\n          "tiers_mode": null,\n          "transform_usage": null,\n          "trial_period_days": null,\n          "usage_type": "licensed"\n        },\n        "price": {\n          "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n          "object": "price",\n          "active": true,\n          "billing_scheme": "per_unit",\n          "created": 1755382872,\n          "currency": "usd",\n          "custom_unit_amount": null,\n          "livemode": false,\n          "lookup_key": null,\n          "metadata": {},\n          "nickname": null,\n          "product": "prod_Ssdk9je3fj3io3",\n          "recurring": {\n            "interval": "month",\n            "interval_count": 1,\n            "meter": null,\n            "trial_period_days": null,\n            "usage_type": "licensed"\n          },\n          "tax_behavior": "unspecified",\n          "tiers_mode": null,\n          "transform_quantity": null,\n          "type": "recurring",\n          "unit_amount": 499,\n          "unit_amount_decimal": "499"\n        },\n        "quantity": 1,\n        "subscription": "sub_1RxYjw090fCkwKBzWkSApq7j",\n        "tax_rates": []\n      }\n    ],\n    "has_more": false,\n    "total_count": 1,\n    "url": "/v1/subscription_items?subscription=sub_1RxYjw090fCkwKBzWkSApq7j"\n  },\n  "latest_invoice": "in_1RxYjv090fCkwKBzLW3lCBbL",\n  "livemode": false,\n  "metadata": {},\n  "next_pending_invoice_item_invoice": null,\n  "on_behalf_of": null,\n  "pause_collection": null,\n  "payment_settings": {\n    "payment_method_options": {\n      "acss_debit": null,\n      "bancontact": null,\n      "card": {\n        "network": null,\n        "request_three_d_secure": "automatic"\n      },\n      "customer_balance": null,\n      "konbini": null,\n      "sepa_debit": null,\n      "us_bank_account": null\n    },\n    "payment_method_types": [\n      "card"\n    ],\n    "save_default_payment_method": "off"\n  },\n  "pending_invoice_item_interval": null,\n  "pending_setup_intent": null,\n  "pending_update": null,\n  "plan": {\n    "id": "price_1RwsTM090fCkwKBzzGwDxzmH",\n    "object": "plan",\n    "active": true,\n    "amount": 499,\n    "amount_decimal": "499",\n    "billing_scheme": "per_unit",\n    "created": 1755382872,\n    "currency": "usd",\n    "interval": "month",\n    "interval_count": 1,\n    "livemode": false,\n    "metadata": {},\n    "meter": null,\n    "nickname": null,\n    "product": "prod_Ssdk9je3fj3io3",\n    "tiers_mode": null,\n    "transform_usage": null,\n    "trial_period_days": null,\n    "usage_type": "licensed"\n  },\n  "quantity": 1,\n  "schedule": null,\n  "start_date": 1755545347,\n  "status": "trialing",\n  "test_clock": null,\n  "transfer_data": null,\n  "trial_end": 1756754947,\n  "trial_settings": {\n    "end_behavior": {\n      "missing_payment_method": "create_invoice"\n    }\n  },\n  "trial_start": 1755545347\n}' message='API response body'
link=https://dashboard.stripe.com/test/logs/req_AJBOr2HYaZEQ94 message='Dashboard link for request'
Using proactor: IocpProactor
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/
Unauthorized: /api/ai/stories/1/start/
Not Found: /api/ai/stories/1/start/
Using proactor: IocpProactor
Internal Server Error: /api/ai/stories/3/start/
Traceback (most recent call last):
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 305, in connect_check_health
    await self.retry.call_with_retry(
        lambda: self._connect(), lambda error: self.disconnect()
    )
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\retry.py", line 50, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 760, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **self._connection_arguments()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lambda: protocol, host, port, **kwds)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 1176, in create_connection
    raise exceptions[0]
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 1146, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
        exceptions, addrinfo, laddr_infos)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 1045, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\proactor_events.py", line 728, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\windows_events.py", line 804, in _poll
    value = callback(transferred, key, ov)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\windows_events.py", line 600, in finish_connect
    ov.getresult()
    ~~~~~~~~~~~~^^
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\rest_framework\viewsets.py", line 125, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\rest_framework\views.py", line 515, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\rest_framework\views.py", line 475, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\rest_framework\views.py", line 486, in raise_uncaught_exception
    raise exc
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\rest_framework\views.py", line 512, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\kaisa\magictale\ai\views.py", line 76, in start
    async_to_sync(run_generation_async)(project.id)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ~~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1776.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\ai\engine.py", line 164, in run_generation_async
    await _send(project_id, {"status": "running", "progress": project.progress})
  File "C:\Users\kaisa\magictale\ai\engine.py", line 58, in _send
    await layer.group_send(f"story_{project_id}", {"type": "progress", "event": event})
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\channels_redis\core.py", line 518, in group_send
    await connection.zremrangebyscore(
        key, min=0, max=int(time.time()) - self.group_expiry
    )
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 1149, in get_connection
    await self.ensure_connection(connection)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 1182, in ensure_connection
    await connection.connect()
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "C:\Users\kaisa\magictale\.venv\Lib\site-packages\redis\asyncio\connection.py", line 315, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\magictale\settings.py changed, reloading.
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\magictale\settings.py changed, reloading.
Watching for file changes with StatReloader
Watching for file changes with StatReloader
Watching for file changes with StatReloader
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\magictale\settings.py changed, reloading.
Watching for file changes with StatReloader
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\magictale\settings.py changed, reloading.
Watching for file changes with StatReloader
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\magictale\settings.py changed, reloading.
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\magictale\settings.py changed, reloading.
Watching for file changes with StatReloader
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\magictale\settings.py changed, reloading.
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\magictale\settings.py changed, reloading.
Watching for file changes with StatReloader
Watching for file changes with StatReloader
Watching for file changes with StatReloader
Watching for file changes with StatReloader
Watching for file changes with StatReloader
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\magictale\settings.py changed, reloading.
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\magictale\settings.py changed, reloading.
Watching for file changes with StatReloader
Watching for file changes with StatReloader
C:\Users\kaisa\magictale\magictale\settings.py changed, reloading.
